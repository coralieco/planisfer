<div class="container-fluid page-result">
  <!-- part with tab and the result -->
  <div class="col-xs-12 col-md-6 no-padding">
    <!-- part with tab showing best results by airports -->
    <div class="displayTrips">
      <div class = "row">
        <div id="TitleShow">
          <h3>CHEAPEST DIRECT FLIGHTS </h3>
          <p> From <strong><%= @starts_on.strftime("%B %e") %></strong> - To <strong><%= @returns_on.strftime("%B %e") %></strong></p>
          <span id="price-for"> Price for <%= @passengers_title %></span>
        </div>
      </div>
      <div class="row" id="see-flights">
        <% @trips_selection.each_with_index do |trip, index| %>
          <%= link_to selections_path(:trip_id => trip.id), class: 'tabLink result-card', 'data-toggle' => "modal", 'data-target' => '#car_wait_modal',method: :post, data: {trip_id: trip.id, colours: @airport_colours} do %>
            <div class="cardContainer <%= 'selected' if index == 0 %> <%= 'hidden the-hidden-results' if index > 2 %>" >
              <div class="card-description">
                <div class="card-description-item">
                  <p>
                    <span class="hours"><%= trip.round_trip_flight.flight1_take_off_at.strftime("%H:%M") %></span>
                    <span class="airport">
                      <%= @city_real_name%> <span class="light-data"> <%= trip.round_trip_flight.flight1_origin_airport_iata %></span>
                    </span>
                  </p>
                  <p>
                    <span class = "<%= @airport_colours[trip.return_city] %>"> <span class="hours"><%= trip.round_trip_flight.flight2_take_off_at.strftime("%H:%M") %></span> <span class="airport"> <%= trip.return_city %><span class="light-data"> <%= trip.round_trip_flight.flight2_origin_airport_iata %> </span> </span> </span>
                  </p>
                </div>
                <div class="card-description-item">
                  <p>
                    <i class="fa fa-long-arrow-right" aria-hidden="true"></i>
                    <span class= "<%= @airport_colours[trip.arrival_city] %>" %> <span class="hours"> <%= trip.round_trip_flight.flight1_landing_at.strftime("%H:%M") %> </span> <span class="airport"><%= trip.arrival_city %> <span class="light-data"><%= trip.round_trip_flight.flight1_destination_airport_iata %></span> </span> </span>
                  </p>
                  <p>
                    <i class="fa fa-long-arrow-right" aria-hidden="true"></i>
                    <span class="hours"><%= trip.round_trip_flight.flight2_landing_at.strftime("%H:%M") %> </span> <span class="airport"> <%= @city_real_name%> <span class="light-data"> <%= trip.round_trip_flight.flight2_destination_airport_iata %> </span> </span>
                  </p>
                </div>
                <div class="card-description-item">
                  <p>
                    <span class="light-data"> <span class="flight-label"> <%= Constants::AIRLINES[trip.round_trip_flight.carrier1]  %> </span> </span>
                  </p>
                  <p>
                    <span class="light-data"> <span class="flight-label"> <%= Constants::AIRLINES[trip.round_trip_flight.carrier2]  %> </span> </span>
                  </p>
                </div>
              </div>
              <div class="price-action">
                <div class="card-price ">
                  <p><%= money_without_cents_and_with_symbol(trip.price.round) %></p>
                </div> <!-- fin card-price -->
              </div>
            </div>
          <% end %>
        <% end %>

      </div>  <!-- fin du row -->

      <div class = "row">

        <div id = "all-flights">
          <%= link_to "javascript:showhide('filters')" do%>
              <p class="<%= 'hidden' if @status == 'block' %>" id="see-filters"><strong>Change search criteria</strong></p>
              <p class="<%= 'hidden' if @status == 'none' %>" id="hide-filters"><strong>Hide filters</strong></p>
          <% end  %>
        </div>

        <div id="more-flights">
          <span id="see-more-flights"><strong>See more flights</strong></span>
          <span class="hidden" id="hide-more-flights"><strong>See less flights</strong></span>
        </div>

      </div>


      <div class = "row">
                <!-- ouverture filters -->
        <div class= "<%= 'not-displayed' if @status == 'none' %>" id="filters">
          <%=form_tag search_path(@search), method: :get, remote: true, id: "searchForm" do %>
          <!-- ouverture row -->


            <div class = "container-fluid">

              <div class = "row">

                <div class = 'row'>

                  <div class = "row">
                    <div class="filter-slider">

                      <div class = 'col-md-6'>
                        <div class = "filer-slider-item">
            <!-- A priori la div ci dessous n'est pas utile -->
                          <div class = "filter-box">

                            <h5 class = "text-center" > From <strong> <%= @city_real_name%> </strong> to <strong> <%= @region.name %> </strong></h5>
                            <div class="filters">
                              <ul class="text-center">
                                <li>
                                  <h3><i class="fa fa-plane"></i> Take-off time</h3>
                                </li>
                                <li>
                                  <%= text_field_tag :flight1_range, nil, class: "bootstrap_slider submit-on-change",
                                  data: { provide: :slider, "slider-value" => "[#{params[:flight1_range] || "4,23" }]", "slider-min" => 4, "slider-max" => 23, "slider-tooltip_split" => true } %>
                                </li>
                              </ul>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class = 'col-md-6'>
                        <div class="filter-slider-item">
                          <div class = "filter-box">
                            <h5 class = "text-center" > From <strong> <%= @region.name %> </strong> to <strong> <%= @city_real_name %></strong></h5>
                            <div class="filters">
                              <ul class="text-center">
                                <li>
                                  <h3><i class="fa fa-plane"></i> Take-off time</h3>
                                </li>

                                <li>
                                  <%= text_field_tag :flight2_range, nil, class: "bootstrap_slider submit-on-change",
                                  data: { provide: :slider, "slider-value" => "[#{params[:flight2_range] || "0,23" }]", "slider-min" => 4, "slider-max" => 23, "slider-tooltip_split" => true } %>
                                </li>
                              </ul>
                            </div>
                          </div>
                        </div>
                      </div>

                    </div>

                  </div>

                </div>


                <div class = 'row'>
                  <div class="filter-buttons">

                    <div class = "row">
                      <h5 class = "airport-filter" > Possible arrival and return <strong>cities </strong></h5>
                    </div>

                    <div class = "row">
                      <% @region_airports.each do |airport| %>
                        <div class = "col-md-3 content-center">
                          <div class = "btn-tag filtered-city <%= 'city-selected' if @selected_airports.include?(airport)%>" data-city="<%= airport%>"><%= airport%></div>
                        </div>
                      <% end %>

                    </div>

                  </div>

                </div>

              </div>

              <div class="row">
                <div class ="text-center filter-apply">
                  <%= hidden_field_tag 'selected-cities', params['selected-cities'], class: "submit-on-change" %>
                  <%# submit_tag "Apply filters", class: "btn-brand" %>
                </div>
              </div>

            </div>

          <% end %>
        </div>
      </div>

    </div> <!-- fin du displaytrips -->


    <div class = "row">

      <div id="poi-title">
        <h3>MAIN POINTS OF INTEREST IN <%= @region.name.upcase%> </h3>
      </div>

      <div class="col-md-12">
        <div class="trending text-center" id="trendy-destination">
          <div class="blocks">
            <% @region.pois.each do |poi| %>
              <span class="block xsm destination" data-toggle="modal" data-target="#modal_1">
                <%= image_tag "#{@region.name.downcase}/#{poi.downcase}.jpg", class:"dest-image"%>
                <span class="box poi-card" data-poi = "<%= Poi.find_by_name(poi.strip).id %>"  data-region = "<%= @region.id %>">
                  <span class="text in-box">
                    <span class="primarytext"> <%= poi %></span>
                  </span>
                </span>
              </span>
            <% end %>
          </div> <!-- fin du blocks -->
        </div> <!-- fin du trending -->
      </div> <!-- fin du 2e col-xs-12 principal -->
    </div>

  </div>

  <div class="col-xs-12 col-md-6">
    <div class = "legends">
      <img><%= image_tag "camera.svg", class: "legend_highlight"%> Points of interest </img>
      <img><%= image_tag "airport-colour-code-0.svg", class: "legend_airport" %> Airports </img>
    </div>
    <div class="airport-map">
      <div id="map", style="width: 100%; height: 600px;"></div>
    </div>
  </div>

</div>

<%= render 'car_wait_modal', modal_name: "car_wait_modal" %>
